<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}App{% endblock %}</title>

  <!-- Tabler 1.4.0 -->
  <link href="https://cdn.jsdelivr.net/npm/@tabler/core@1.4.0/dist/css/tabler.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css" rel="stylesheet">

  <style>
    /* Žádné tvrdé barvy – použijeme Tabler proměnné, aby fungoval dark mode */
    body { background: var(--tblr-bg-surface); }

    /* Volitelně: sjednocený povrch můžeš dělat kartami, ne custom pozadím */
    .content-wrap { /* jen odsazení kontejneru */
      padding-top: 1rem;
      padding-bottom: 1rem;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- Navbar -->
    <header class="navbar navbar-expand-md navbar-light border-bottom d-print-none">
      <div class="container-xl">
        <a class="navbar-brand" href="/dashboard">
          <span class="navbar-brand-text">Dashboard</span>
        </a>

        <div class="navbar-nav flex-row order-md-last">
          <!-- Theme toggle -->
          <a href="#" class="nav-link px-2" id="theme-toggle" title="Toggle theme" aria-label="Toggle theme">
            <i class="ti ti-moon-stars"></i>
          </a>
          <a class="nav-link px-2" href="{{ url_for('main.account') }}">Account</a>
          <a class="nav-link px-2" href="{{ url_for('main.logout') }}">Logout</a>
        </div>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbar-menu">
          <ul class="navbar-nav">
            <li class="nav-item"><a class="nav-link" href="/my_company"><i class="ti ti-building"></i><span class="ms-2">My company</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/add_client"><i class="ti ti-user-plus"></i><span class="ms-2">Add Client</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/add_invoice"><i class="ti ti-file-invoice"></i><span class="ms-2">Create invoice</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/clients"><i class="ti ti-users"></i><span class="ms-2">Clients</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/invoices"><i class="ti ti-file-dollar"></i><span class="ms-2">Invoices</span></a></li>
            <li class="nav-item"><a class="nav-link" href="/ai_invoice"><i class="ti ti-sparkles"></i><span class="ms-2">AI generator</span></a></li>
          </ul>
        </div>
      </div>
    </header>

    <!-- Content -->
    <div class="page-wrapper">
      <div class="container-fluid content-wrap">
        <!-- Používej karty místo vlastních bílých boxů -->
        <div class="card card-body">
          {% block content %}{% endblock %}
        </div>
      </div>
    </div>
  </div>

  <!-- Tabler JS -->
  <script src="https://cdn.jsdelivr.net/npm/@tabler/core@1.4.0/dist/js/tabler.min.js"></script>

  <!-- Theme toggler: light/dark, s perzistencí -->
  <script>
    (function(){
      const KEY = 'theme'; // 'light' | 'dark' | 'auto'
      const root = document.documentElement;
      const apply = (mode) => {
        if (mode === 'auto') {
          const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          root.setAttribute('data-bs-theme', prefersDark ? 'dark' : 'light');
        } else {
          root.setAttribute('data-bs-theme', mode);
        }
      };
      apply(localStorage.getItem(KEY) || 'light');
      document.getElementById('theme-toggle')?.addEventListener('click', (e)=>{
        e.preventDefault();
        const cur = root.getAttribute('data-bs-theme') || 'light';
        const next = cur === 'light' ? 'dark' : 'light';
        localStorage.setItem(KEY, next);
        apply(next);
      });
      // Pokud chceš AUTO reagující na systém, nastav initial na 'auto' a odkomentuj:
      // window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', ()=> apply(localStorage.getItem(KEY) || 'auto'));
    })();
  </script>
</body>
</html>
